# import gmpy2
# from Crypto.Util.number import *
# from flag import flag
# m=bytes_to_long(flag.encode())
# p=getPrime(1024)
# q=getPrime(1024)
# n=p*q
# e=65537
# c=pow(m*q+n,e,n)
# print("n=",n)
# print("c=",c)

# # n= 12200022970441251379842135220946842742499501280300027205008541719581576548597053613129489885324781308049170504856955537495857224432548274632637410597587825539054157519621597689639972903585495739124537554848865162458082222130109084153948264002654067021676777105082832260287663173228952329131681023214959907176990159298748918604019157289883776725062282856752043218989095075494294521869830790952229497526096459030803198260906806735842145916405153271858678597880402907681470462914137189411135520636646929485852496820777673669887889496235797597803705442043039887256424915321989972199657144896748324981923536923303793036913
# # c= 10790682875746300887493187894166936931198320977411360108487817433477559577067946376658869666615383959452738657444976000788738396909046336383675180985328264548813819677897193526040252505588005903684626449990453423995556994910662619744143382001923628337605383269804219384612812106431649211669376417250868506366262914229184590928107835166396160725260690575248913934246096904196110179414921458526838035274143777793481952235974953310519010743183316222884581450905575843818486146902293081622469263052309500822086183576562540464089514129198734893483923759281055975866459204788097699738094507728661567227248591092574849922559
# # e=65537


from Crypto.Util.number import *

n= 12200022970441251379842135220946842742499501280300027205008541719581576548597053613129489885324781308049170504856955537495857224432548274632637410597587825539054157519621597689639972903585495739124537554848865162458082222130109084153948264002654067021676777105082832260287663173228952329131681023214959907176990159298748918604019157289883776725062282856752043218989095075494294521869830790952229497526096459030803198260906806735842145916405153271858678597880402907681470462914137189411135520636646929485852496820777673669887889496235797597803705442043039887256424915321989972199657144896748324981923536923303793036913
c= 10790682875746300887493187894166936931198320977411360108487817433477559577067946376658869666615383959452738657444976000788738396909046336383675180985328264548813819677897193526040252505588005903684626449990453423995556994910662619744143382001923628337605383269804219384612812106431649211669376417250868506366262914229184590928107835166396160725260690575248913934246096904196110179414921458526838035274143777793481952235974953310519010743183316222884581450905575843818486146902293081622469263052309500822086183576562540464089514129198734893483923759281055975866459204788097699738094507728661567227248591092574849922559
e=65537

q = GCD(c, n)
p = n // q
print("q =", q)
print("p =", p)
phi_p = p - 1
d_p = inverse(e, phi_p)

# 计算 c mod p
c_p = c % p
# 计算 q^{-e} mod p
q_inv_e = pow(inverse(q, p), e, p)
t = (c_p * q_inv_e) % p
m_mod_p = pow(t, d_p, p)

flag = long_to_bytes(m_mod_p)  #整数转化为字节流
print("Flag:", flag)  #SKSEC{25a1d47a-50ec-11ef-8fbe-743af4fbda8d}